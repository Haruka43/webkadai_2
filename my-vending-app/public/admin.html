<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  - Smart Vendor</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      /* ç®¡ç†ç”»é¢ç”¨ã®è¿½åŠ ãƒ‡ã‚¶ã‚¤ãƒ³ */
      body {
        background-color: #333;
      } /* è£æ–¹ã£ã½ã„è‰² */
      .admin-controls {
        display: flex;
        gap: 10px;
        margin-top: 10px;
      }
      input {
        width: 60px;
        padding: 5px;
        border-radius: 5px;
        border: 1px solid #ccc;
      }
      .restock-btn {
        background-color: #27ae60; /* ç·‘è‰² */
      }
      .restock-btn:hover {
        background-color: #2ecc71;
      }
      .back-link {
        display: block;
        text-align: center;
        margin-top: 20px;
        color: #3498db;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ”§ åœ¨åº«ç®¡ç†ç”»é¢</h1>
      <div id="admin-list" class="vending-machine"></div>
      <a href="/" class="back-link">â† ãŠå®¢ã•ã‚“ç”»é¢ã«æˆ»ã‚‹</a>
    </div>

    <script>
      // å•†å“èª­ã¿è¾¼ã¿
      async function loadAdminProducts() {
        const res = await fetch('/api/products');
        const products = await res.json();
        const container = document.getElementById('admin-list');
        container.innerHTML = '';

        products.forEach((p) => {
          const div = document.createElement('div');
          div.className = 'product-item';
          div.innerHTML = `
                    <h3>${p.name}</h3>
                    <p>ç¾åœ¨: <strong>${p.stock}</strong> å€‹</p>
                    <div class="admin-controls">
                        <input type="number" id="amount-${p.id}" value="5" min="1">
                        <button class="restock-btn" onclick="restock(${p.id})">è£œå……</button>
                    </div>
                `;
          container.appendChild(div);
        });
      }

      // è£œå……å‡¦ç†
      async function restock(id) {
        const amountInput = document.getElementById(`amount-${id}`);
        const amount = parseInt(amountInput.value);

        const res = await fetch('/api/restock', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id: id, amount: amount })
        });

        if (res.ok) {
          alert('è£œå……ã—ã¾ã—ãŸï¼');
          loadAdminProducts(); // è¡¨ç¤ºã‚’æ›´æ–°
        }
      }

      loadAdminProducts();
    </script>
  </body>
</html>
